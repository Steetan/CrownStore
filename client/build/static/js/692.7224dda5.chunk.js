"use strict";(self.webpackChunkcrown_store=self.webpackChunkcrown_store||[]).push([[692],{7692:(s,e,t)=>{t.r(e),t.d(e,{default:()=>_});var a=t(5043),l=t(3840),o=t(8202),r=t(5163),n=t(3216),c=t(5475),i=t(3003),d=t(4858),u=t(5795),p=t(9964),m=t(7843),h=t(2885),w=t(579);const _=s=>{let{}=s;const[e,t]=a.useState(!1),[_,g]=a.useState(!1),b=a.useRef(null),{register:x,handleSubmit:f,formState:{errors:j}}=(0,d.mN)(),{userImgUrl:N}=(0,i.d4)((s=>s.authSlice)),k=(0,o.j)(),y=(0,n.Zp)();a.useEffect((()=>{(async()=>{const{data:s}=await l.A.get("auth/meinfo");t(s.access)})()}),[]);return(0,w.jsxs)("div",{className:"settings",children:[(0,w.jsx)("h2",{className:"settings__title",children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430"}),(0,w.jsxs)("div",{className:"settings__main-block",children:[(0,w.jsx)(h.Ll,{}),(0,w.jsxs)("div",{className:"settings__block-right",children:[(0,w.jsxs)("form",{className:"settings__password-block",onSubmit:f((async s=>{try{var e;if(s.userPassword&&(null===(e=s.userPassword)||void 0===e?void 0:e.length)<6&&alert("\u041f\u0430\u0440\u043e\u043b\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043c\u0438\u043d\u0438\u043c\u0443\u043c 6 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"),s.userPassword&&s.userPassword===s.userPasswordRepeat){const{data:e}=await l.A.patch("/auth/updpass",{password:s.userPassword});e&&alert("\u041f\u0430\u0440\u043e\u043b\u044c \u0431\u044b\u043b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0438\u0437\u043c\u0435\u043d\u0435\u043d")}else alert("\u041f\u0430\u0440\u043e\u043b\u0438 \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0442")}catch(t){console.log(t),alert("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c")}})),children:[(0,w.jsx)("h3",{className:"form-block__title settings__password-title",children:"\u041d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c"}),(0,w.jsxs)("div",{className:"settings__password-inputs",children:[(0,w.jsxs)("div",{className:"settings__password-input",children:[(0,w.jsx)(u.A,{type:_?"text":"password",id:"outlined-basic",label:"\u041f\u0430\u0440\u043e\u043b\u044c",className:"form-block__input form-block__input--password",variant:"outlined",...x("userPassword",{required:"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c"})}),j.userPassword&&(0,w.jsx)("p",{style:{color:"red"},children:j.userPassword.message})]}),(0,w.jsx)("div",{className:"settings__password-hr"}),(0,w.jsxs)("div",{className:"settings__password-input",children:[(0,w.jsx)(u.A,{type:_?"text":"password",id:"outlined-basic",label:"\u041f\u0430\u0440\u043e\u043b\u044c \u0435\u0449\u0435 \u0440\u0430\u0437",className:"form-block__input form-block__input--password",variant:"outlined",...x("userPasswordRepeat",{required:"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c \u0435\u0449\u0435 \u0440\u0430\u0437"})}),j.userPasswordRepeat&&(0,w.jsx)("p",{style:{color:"red"},children:j.userPasswordRepeat.message})]})]}),(0,w.jsx)(p.A,{value:_,onChange:()=>g(!_),control:(0,w.jsx)(m.A,{}),label:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c"}),(0,w.jsx)("div",{className:"settings__btn-password-block",children:(0,w.jsx)("button",{className:"button button--footer settings__btn-password-update",children:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c"})})]}),!N&&(0,w.jsx)("label",{htmlFor:"file-upload",className:"custom-file-upload",children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0444\u043e\u0442\u043e"}),(0,w.jsx)("input",{id:"file-upload",ref:b,type:"file",style:{display:"none"},onChange:async s=>{try{const e=new FormData;e.append("image",s.target.files[0]),await l.A.post("".concat("http://localhost:8080","/upload/user"),e).then((s=>{let{data:e}=s;try{k((0,r.W0)("".concat(e.url))),l.A.patch("/auth/updimg",{img:e.url}).then((s=>{let{data:e}=s;e&&alert("\u0410\u0432\u0430\u0442\u0430\u0440\u043a\u0430 \u0431\u044b\u043b\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0430")}))}catch(t){console.log(t),alert("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440\u043a\u0443")}}))}catch(e){console.warn(e)}}}),N&&(0,w.jsx)("button",{className:"settings__btn-delete",onClick:async()=>{if(window.confirm("\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0430\u043a\u043a\u0430\u0443\u043d\u0442?")){try{await l.A.delete("".concat("http://localhost:8080","/upload/user/delete/").concat(N)),b.current&&(b.current.value=""),await l.A.patch("/auth/updimg",{img:""})}catch(s){console.log(s)}k((0,r.W0)(""))}},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435"}),(0,w.jsx)("img",{className:"form-block__img-upload",src:"".concat("http://localhost:8080","/uploads/userIcons/").concat(N),alt:""})]})]}),(0,w.jsx)("button",{className:"settings__btn-delete settings__btn-delete--acc",onClick:async()=>{window.confirm("\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0430\u043a\u043a\u0430\u0443\u043d\u0442?")&&!e&&(await l.A.delete("/cart/deleteallbyid"),await k((0,r.u9)(window.localStorage.getItem("token"))).finally((()=>{window.localStorage.removeItem("token"),y("/")})),window.location.reload())},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0430\u043a\u043a\u0430\u0443\u043d\u0442"}),(0,w.jsx)(c.N_,{to:"/",className:"button button--black",style:{marginTop:20},children:(0,w.jsx)("span",{children:"\u0412\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f \u043d\u0430\u0437\u0430\u0434"})})]})}}}]);
//# sourceMappingURL=692.7224dda5.chunk.js.map
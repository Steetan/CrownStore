{"version":3,"file":"static/js/440.37ab2275.chunk.js","mappings":"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","sources":["pages/Registration.tsx"],"sourcesContent":["import React from 'react'\r\nimport { useForm } from 'react-hook-form'\r\nimport { RootState, useAppDispatch } from '../redux/store'\r\nimport { fetchRegister, fetchUserMe, setUserImgUrl } from '../redux/slices/authSlice'\r\nimport { useSelector } from 'react-redux'\r\nimport { Link, useNavigate } from 'react-router-dom'\r\nimport { TextField } from '@mui/material'\r\nimport customAxios from '../axios'\r\nimport axios from 'axios'\r\n\r\nexport interface FormData {\r\n\tname: string\r\n\tfname: string\r\n\toname: string\r\n\temail: string\r\n\tphone: number\r\n\tpassword: string\r\n\tconfirmPassword: string\r\n\turl?: string\r\n}\r\n\r\nconst Registration = ({}) => {\r\n\tconst dispatch = useAppDispatch()\r\n\tconst { userImgUrl } = useSelector((state: RootState) => state.authSlice)\r\n\tconst navigate = useNavigate()\r\n\r\n\tconst inputFileRef = React.useRef<HTMLInputElement>(null)\r\n\r\n\tconst {\r\n\t\tregister,\r\n\t\thandleSubmit,\r\n\t\tformState: { errors },\r\n\t} = useForm<FormData>()\r\n\r\n\tconst onSubmit = async (values: FormData) => {\r\n\t\tconst data = await dispatch(fetchRegister({ ...values, url: userImgUrl }))\r\n\r\n\t\tif (!data.payload) {\r\n\t\t\treturn alert('Не удалось зарегистрироваться!')\r\n\t\t}\r\n\r\n\t\tif (data.payload.token) {\r\n\t\t\twindow.localStorage.setItem('token', data.payload.token)\r\n\t\t\tnavigate('/')\r\n\t\t}\r\n\t}\r\n\r\n\tReact.useEffect(() => {\r\n\t\tconst fetchMe = async () => {\r\n\t\t\tconst data = await dispatch(fetchUserMe())\r\n\t\t\tif (data?.payload) {\r\n\t\t\t\treturn navigate('/')\r\n\t\t\t}\r\n\t\t}\r\n\t\tfetchMe()\r\n\t}, [])\r\n\r\n\tconst handleFileChange = async (event: any) => {\r\n\t\ttry {\r\n\t\t\tconst formData = new FormData()\r\n\t\t\tformData.append('image', event.target.files[0])\r\n\r\n\t\t\tcustomAxios\r\n\t\t\t\t.post(`${process.env.REACT_APP_SERVER_URL}/upload/user`, formData)\r\n\t\t\t\t.then(({ data }) => {\r\n\t\t\t\t\tdispatch(setUserImgUrl(`${data.url}`))\r\n\t\t\t\t})\r\n\t\t} catch (error) {\r\n\t\t\tconsole.warn(error)\r\n\t\t}\r\n\t}\r\n\r\n\tconst deleteImg = () => {\r\n\t\ttry {\r\n\t\t\taxios.delete(`${process.env.REACT_APP_SERVER_URL}/upload/auth/delete/${userImgUrl}`)\r\n\t\t\tif (inputFileRef.current) {\r\n\t\t\t\tinputFileRef.current.value = ''\r\n\t\t\t}\r\n\t\t\tdispatch(setUserImgUrl(''))\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log(error)\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className='form-block-wrapper'>\r\n\t\t\t<div className='form-block'>\r\n\t\t\t\t<h3 className='form-block__title'>Регистрация</h3>\r\n\t\t\t\t<form onSubmit={handleSubmit(onSubmit)}>\r\n\t\t\t\t\t<div className='form-block__inputs'>\r\n\t\t\t\t\t\t<TextField\r\n\t\t\t\t\t\t\terror={errors.password && true}\r\n\t\t\t\t\t\t\tid='outlined-basic'\r\n\t\t\t\t\t\t\tclassName='form-block__input'\r\n\t\t\t\t\t\t\tlabel='Имя'\r\n\t\t\t\t\t\t\tvariant='outlined'\r\n\t\t\t\t\t\t\t{...register('name', { required: 'Укажите имя' })}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{errors.name && <p style={{ color: 'red' }}>{errors.name.message}</p>}\r\n\t\t\t\t\t\t<TextField\r\n\t\t\t\t\t\t\terror={errors.password && true}\r\n\t\t\t\t\t\t\tid='outlined-basic'\r\n\t\t\t\t\t\t\tlabel='Фамилия'\r\n\t\t\t\t\t\t\tclassName='form-block__input'\r\n\t\t\t\t\t\t\tvariant='outlined'\r\n\t\t\t\t\t\t\t{...register('fname', { required: 'Укажите фамилию' })}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{errors.fname && <p style={{ color: 'red' }}>{errors.fname.message}</p>}\r\n\t\t\t\t\t\t<TextField\r\n\t\t\t\t\t\t\terror={errors.password && true}\r\n\t\t\t\t\t\t\tid='outlined-basic'\r\n\t\t\t\t\t\t\tlabel='Отчество'\r\n\t\t\t\t\t\t\tclassName='form-block__input'\r\n\t\t\t\t\t\t\tvariant='outlined'\r\n\t\t\t\t\t\t\t{...register('oname', { required: 'Укажите отчество' })}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{errors.oname && <p style={{ color: 'red' }}>{errors.oname.message}</p>}\r\n\t\t\t\t\t\t<TextField\r\n\t\t\t\t\t\t\terror={errors.password && true}\r\n\t\t\t\t\t\t\tid='outlined-basic'\r\n\t\t\t\t\t\t\tlabel='Email'\r\n\t\t\t\t\t\t\tclassName='form-block__input'\r\n\t\t\t\t\t\t\tvariant='outlined'\r\n\t\t\t\t\t\t\t{...register('email', { required: 'Укажите почту' })}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{errors.email && <p style={{ color: 'red' }}>{errors.email.message}</p>}\r\n\t\t\t\t\t\t<TextField\r\n\t\t\t\t\t\t\terror={errors.password && true}\r\n\t\t\t\t\t\t\tid='outlined-basic'\r\n\t\t\t\t\t\t\tlabel='Номер телефона'\r\n\t\t\t\t\t\t\tclassName='form-block__input'\r\n\t\t\t\t\t\t\tvariant='outlined'\r\n\t\t\t\t\t\t\t{...register('phone', { required: 'Укажите номер телефона' })}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{errors.phone && <p style={{ color: 'red' }}>{errors.phone.message}</p>}\r\n\t\t\t\t\t\t<TextField\r\n\t\t\t\t\t\t\terror={errors.password && true}\r\n\t\t\t\t\t\t\tid='outlined-basic'\r\n\t\t\t\t\t\t\tlabel='Пароль'\r\n\t\t\t\t\t\t\tclassName='form-block__input'\r\n\t\t\t\t\t\t\tvariant='outlined'\r\n\t\t\t\t\t\t\ttype='password'\r\n\t\t\t\t\t\t\t{...register('password', { required: 'Укажите пароль' })}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{errors.password && <p style={{ color: 'red' }}>{errors.password.message}</p>}\r\n\t\t\t\t\t\t{!userImgUrl && (\r\n\t\t\t\t\t\t\t<label htmlFor='file-upload' className='custom-file-upload'>\r\n\t\t\t\t\t\t\t\tЗагрузить фото\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\tid='file-upload'\r\n\t\t\t\t\t\t\tref={inputFileRef}\r\n\t\t\t\t\t\t\ttype='file'\r\n\t\t\t\t\t\t\tstyle={{ display: 'none' }}\r\n\t\t\t\t\t\t\tonChange={handleFileChange}\r\n\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t{userImgUrl && (\r\n\t\t\t\t\t\t\t<button className='settings__btn-delete' onClick={deleteImg}>\r\n\t\t\t\t\t\t\t\tУдалить\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\tclassName='form-block__img-upload'\r\n\t\t\t\t\t\t\tsrc={`${process.env.REACT_APP_SERVER_URL}/uploads/userIcons/${userImgUrl}`}\r\n\t\t\t\t\t\t\talt=''\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className='form-block__btns'>\r\n\t\t\t\t\t\t<button type='submit' className='button button--footer'>\r\n\t\t\t\t\t\t\tЗарегистрироваться\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\tЕсть аккаунт?\r\n\t\t\t\t\t\t\t<Link to='/auth/login' className='button-link-reg'>\r\n\t\t\t\t\t\t\t\t{' '}\r\n\t\t\t\t\t\t\t\tВойти\r\n\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</form>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default Registration\r\n"],"names":["_ref","dispatch","useAppDispatch","userImgUrl","useSelector","state","authSlice","navigate","useNavigate","inputFileRef","React","register","handleSubmit","formState","errors","useForm","async","data","fetchUserMe","payload","fetchMe","_jsx","className","children","_jsxs","onSubmit","fetchRegister","values","url","alert","token","window","localStorage","setItem","TextField","error","password","id","label","variant","required","name","style","color","message","fname","oname","email","phone","type","htmlFor","ref","display","onChange","formData","FormData","append","event","target","files","customAxios","post","concat","process","then","_ref2","setUserImgUrl","console","warn","onClick","deleteImg","axios","delete","current","value","log","src","alt","Link","to"],"sourceRoot":""}